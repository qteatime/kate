<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Release notes" href="../etc/releases/index.html" /><link rel="prev" title="#01XX — External URL navigation" href="01XX-external-url.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.03.27 -->
        <title>#01XX — Device file access - Kate 0.23.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     Both Kate and this documentation are a work in progress and may change at any time. 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Kate 0.23.6 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Kate 0.23.6 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">End-user books</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/manual/index.html">The Kate User Manual</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/manual/intro/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/intro/hardware.html">Tech specs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/intro/emulator.html">Emulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/intro/install.html">Installing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/manual/gaming/index.html">Playing games</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/gaming/cartridges.html">ROM Cartridges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/gaming/captures.html">Screen recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/gaming/save-data.html">Save data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/gaming/play-habits.html">Play habits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/gaming/storage.html">Stored data</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/manual/security/index.html">Security and privacy</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/security/philosophy.html">Safety philosophy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/security/sandboxing.html">Sandboxing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/security/privacy.html">Privacy policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/security/trust.html">Trust and consent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/manual/security/indicators.html">Resource indicators</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Game developer books</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dev/manual/index.html">Making games for Kate!</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dev/manual/intro/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/intro/why.html">Why make games for Kate?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/intro/setup.html">What will you need?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/intro/hello-world.html">Hello, World</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dev/manual/model/index.html">Programming model</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/model/overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/model/cartridges.html">Cartridges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/model/sandboxing.html">Sandboxing and APIs</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dev/manual/api/index.html">Kate API</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/api/events.html"><code class="docutils literal notranslate"><span class="pre">events</span></code> — Event handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/api/cart-fs.html"><code class="docutils literal notranslate"><span class="pre">cart_fs</span></code> — Reading files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/api/input.html"><code class="docutils literal notranslate"><span class="pre">*_input</span></code> — Reacting to player input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/api/timer.html"><code class="docutils literal notranslate"><span class="pre">timer</span></code> — Scheduling updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/api/capture.html"><code class="docutils literal notranslate"><span class="pre">capture</span></code> — Screenshots and video recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/api/store.html"><code class="docutils literal notranslate"><span class="pre">store</span></code> — Saving state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/api/browser.html"><code class="docutils literal notranslate"><span class="pre">browser</span></code> — Navigating to URLs</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dev/manual/web/index.html">Web game support</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/web/basics.html">Basics of porting</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../dev/manual/web/bridges/index.html">Bridges</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/network-proxy.html">Network proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/input-proxy.html">Button input proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/pointer-input-proxy.html">Pointer input proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/local-storage-proxy.html">Local storage proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/indexeddb-proxy.html">IndexedDB proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/preserve-webgl-render.html">Preserve WebGL Render</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/capture-canvas.html">Capture canvas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/manual/web/bridges/renpy-tweaks.html">Ren’Py tweaks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dev/manual/kart/index.html">Kart — Packing cartridges</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/kart/getting-started.html">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/manual/kart/configuration.html">Configuration files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dev/port/index.html">Kate Porting Recipes</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/port/bitsy.html">Bitsy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/port/renpy.html">Ren’Py</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design and implementation</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Kate’s Design Documents</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00XX-capabilities.html">#00XX — Capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="00XX-live-audit.html"># 00XX - Live auditing</a></li>
<li class="toctree-l2"><a class="reference internal" href="0101-object-storage.html">#0101 — Object Store API</a></li>
<li class="toctree-l2"><a class="reference internal" href="01XX-external-url.html">#01XX — External URL navigation</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">#01XX — Device file access</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changes, Terms, and Credits</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../etc/releases/index.html">Release notes</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../etc/releases/0.23.6.html">Kate v0.23.6  (June 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../etc/releases/0.23.5.html">Kate v0.23.5  (May 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../etc/releases/0.23.4.html">Kate v0.23.4  (April 2023)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../etc/licence.html">Terms of use</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../py-modindex.html">Module Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/qteatime/kate/edit/main/docs/source/design/01XX-device-file-access.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="xx-device-file-access">
<h1>#01XX — Device file access<a class="headerlink" href="#xx-device-file-access" title="Permalink to this heading">#</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Q.</p>
</dd>
<dt class="field-even">Started<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-08-12</p>
</dd>
<dt class="field-odd">Last updated<span class="colon">:</span></dt>
<dd class="field-odd"><p>2023-08-12</p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>PoC in progress</p>
</dd>
</dl>
<section id="timeline">
<h2>Timeline<a class="headerlink" href="#timeline" title="Permalink to this heading">#</a></h2>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>First draft</p></th>
<th class="head"><p>Proof of Concept</p></th>
<th class="head"><p>Stable implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2023-08-12</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>While games don’t need access to files outside of what’s included in the
cartridge, Kate is also a platform for running regular applications and
game development tools (such as Kate Importer or Kate Studio) need
to read files from the device’s file system.</p>
<p>We want to make sure that any operations accessing user data has the
proper security and privacy controls and feedback in place, and they
also allow users to revoke access immediately at any time. To that end
all such accesses must go through a Kate-controlled API. In the case
of device files, this document introduces the Device File Access API.</p>
<p>The Device File Access API provides a baseline of operations on files
and directories. It’s guided by the same principles of active and informed
consent that permeate other Kate features: processes are only granted
restricted access to files users agree to let them read.</p>
</section>
<section id="technical-implementation">
<h2>Technical implementation<a class="headerlink" href="#technical-implementation" title="Permalink to this heading">#</a></h2>
<p>The Device File Access API is similar to the web’s File Access API and
Crochet’s file system package, in that we rely on contextual grants for
file capabilities and provide individual file objects that can be used
to further access objects under them.</p>
<p>Cartridges and Kate processes can ask for the API object, which is a
passive grant if they have the Device File Access capability granted.
They can then use any of the entry-point methods in this API to request
access to a specific node in the file system tree. Nodes can be directories
or files — the API does not provide any concept of links or devices.</p>
<p>Nodes are represented as either a file or a directory object. These are
membranes exposed to outside processes, and all actual operations happen
within the Device File Access API. This means that capabilities are still
checked upon each read, write, or similar operation; users must have both
the object capability to the node <strong>and</strong> the general capability to use
the Device File Access API for all operations to succeed.</p>
<p>Handles are not persistent: they’re gone as soon as the process is closed.
Every time the process is re-opened, it needs to request the capabilities
to the nodes again.</p>
<p>For this implementation, all file operations are atomic and synchronous.
This increases the memory requirements of Kate, but streaming and random
access APIs require more thought.</p>
</section>
<section id="formal-semantics">
<h2>Formal semantics<a class="headerlink" href="#formal-semantics" title="Permalink to this heading">#</a></h2>
<p>The entire Device File Access API is governed by a simple core language
based on a file system tree. This language is described as follows:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span><span class="w"> </span><span class="kt">File</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Pathname</span><span class="p">,</span><span class="w"> </span><span class="kr">data</span><span class="w"> </span><span class="p">}</span>

<span class="kr">type</span><span class="w"> </span><span class="kt">Pathname</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">::</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="kt">Root</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="kt">Join</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">segment</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">}</span>

<span class="kr">type</span><span class="w"> </span><span class="kt">FileFilter</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">multiple</span><span class="kt">:</span><span class="w"> </span><span class="n">boolean</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">false</span><span class="p">;</span>
<span class="w">  </span><span class="n">strict</span><span class="kt">:</span><span class="w"> </span><span class="n">boolean</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">true</span><span class="p">;</span>
<span class="w">  </span><span class="n">types</span><span class="kt">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">description</span><span class="kt">:</span><span class="w"> </span><span class="n">string</span><span class="p">;</span>
<span class="w">    </span><span class="n">accept</span><span class="kt">:</span><span class="w"> </span><span class="p">{[</span><span class="n">mime</span><span class="kt">:</span><span class="w"> </span><span class="n">string</span><span class="p">]</span><span class="kt">:</span><span class="w"> </span><span class="n">string</span><span class="kt">[]</span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="kt">[]</span>
<span class="p">}</span>

<span class="kt">DeviceFiles</span><span class="w"> </span><span class="n">fs</span><span class="w"> </span><span class="ow">::</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">fs</span><span class="o">.</span><span class="n">request</span><span class="o">-</span><span class="n">file</span><span class="p">(</span><span class="kt">FileFilter</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="p">,</span><span class="w"> </span><span class="n">fN</span><span class="p">]}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="ne">error</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">fs</span><span class="o">.</span><span class="n">request</span><span class="o">-</span><span class="n">directory</span><span class="nb">()</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="p">,</span><span class="w"> </span><span class="n">fN</span><span class="p">]}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="ne">error</span>

<span class="kt">File</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">::</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="o">.</span><span class="n">relative</span><span class="o">-</span><span class="n">path</span><span class="nb">()</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Pathname</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="nb">()</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Bytes</span>
</pre></div>
</div>
<p>Thus a user of this API starts by getting access to a <cite>DeviceFiles</cite> instance.
From there they may request access to a collection of files, or to a
directory. These result in File handles which then allow the user to read
files in the underlying device file system — the files are a snapshot at
the time they’re requested.</p>
<p>Symbolic and hard links are followed during this navigation. However, users
only have access to the path of the file relative to the top-most directory
they have been given access to.</p>
<section id="requesting-capabilities">
<h3>Requesting capabilities<a class="headerlink" href="#requesting-capabilities" title="Permalink to this heading">#</a></h3>
<p>Users start with no access to any file. They must first request contextual
grants to specific file or directory nodes.</p>
<section id="fs-request-file-filter">
<h4><code class="docutils literal notranslate"><span class="pre">fs.request-file(filter)</span></code><a class="headerlink" href="#fs-request-file-filter" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Show a file picker where:</p>
<ul>
<li><p>Users can select multiple entries if <code class="docutils literal notranslate"><span class="pre">filter.multiple</span></code> is true;</p></li>
<li><p>Users can select files matching the provided mime-type filters; and</p></li>
<li><p>Users may select any non-mime-type matching file if <code class="docutils literal notranslate"><span class="pre">filter.strict</span></code> is false;</p></li>
<li><p>The selectable files does not include system data — only user data must be selectable.</p></li>
</ul>
</li>
<li><p>If the user selects a file:</p>
<ul>
<li><p>Return a list of File handles for the selected files.</p></li>
</ul>
</li>
<li><p>Otherwise:</p>
<ul>
<li><p>Return a generic access failure.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</section>
<section id="fs-request-directory">
<h4><code class="docutils literal notranslate"><span class="pre">fs.request-directory()</span></code><a class="headerlink" href="#fs-request-directory" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Show a directory picker where selectable directories do not include system
data — only user data must be selectable.</p></li>
<li><p>If the user selects a directory:</p>
<ul>
<li><p>Return a list of File handles for all files contained within the selected
directory which are not system data;</p></li>
</ul>
</li>
<li><p>Otherwise:</p>
<ul>
<li><p>Return a generic access failure.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</section>
</section>
<section id="file-metadata">
<h3>File metadata<a class="headerlink" href="#file-metadata" title="Permalink to this heading">#</a></h3>
<p>Given any File handle we can get some metadata about it. Metadata from a file
will <strong>never</strong> allow one to get a more privileged node than the one the
operation was called on.</p>
<section id="f-relative-path">
<h4><code class="docutils literal notranslate"><span class="pre">f.relative-path()</span></code><a class="headerlink" href="#f-relative-path" title="Permalink to this heading">#</a></h4>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kt">File</span><span class="p">{</span><span class="n">path</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">P</span><span class="p">}</span><span class="o">.</span><span class="n">relative</span><span class="o">-</span><span class="n">path</span><span class="nb">()</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">P</span><span class="p">;</span>
</pre></div>
</div>
<p>A relative path is just a sequence of segments starting from the node
we’re in, and following the parent chain until the root directory that granted
access to this file. This means that pathnames are canonically in reverse form.
E.g.: a path like <code class="docutils literal notranslate"><span class="pre">some/directory/file.txt</span></code> would be represented as
<code class="docutils literal notranslate"><span class="pre">Join</span> <span class="pre">{&quot;file.txt&quot;,</span> <span class="pre">Join</span> <span class="pre">{&quot;directory&quot;,</span> <span class="pre">Join</span> <span class="pre">{&quot;some&quot;,</span> <span class="pre">Root}}}</span></code>.</p>
</section>
</section>
<section id="file-operations">
<h3>File operations<a class="headerlink" href="#file-operations" title="Permalink to this heading">#</a></h3>
<p>Given a File handle, the user can only retrieve its contents.</p>
<section id="f-read">
<h4><code class="docutils literal notranslate"><span class="pre">f.read()</span></code><a class="headerlink" href="#f-read" title="Permalink to this heading">#</a></h4>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kt">File</span><span class="p">{</span><span class="kr">data</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">D</span><span class="p">}</span><span class="o">.</span><span class="n">read</span><span class="nb">()</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">has</span><span class="p">(</span><span class="n">file_access</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">D</span>
</pre></div>
</div>
<p>That is, if we read from a file handle then we synchronously get access to all
of the binary data stored at that node, as long as we still have the file_access
capability.</p>
</section>
</section>
</section>
<section id="how-is-this-feature-dangerous">
<h2>How is this feature dangerous?<a class="headerlink" href="#how-is-this-feature-dangerous" title="Permalink to this heading">#</a></h2>
<p>Device File Access API is a high risk API which provides cartridges with
read-only access to files or directories selected by the user. In that sense
it poses considerable privacy and security risks in the hands of a malicious
cartridge. We consider risks from the Kernel, Device, Cartridge, and Users’
perspective here.</p>
<dl>
<dt><strong>Leaking sensitive data:</strong></dt><dd><p>The API provides access to user data and cannot make any guarantees about
contents. Further, as it relies on browser file pickers in the web, it
cannot show the user a preview of the contents before they’re shared. This
means that a malicious cartridge can trick users into giving them access
to sensitive data, if the user cannot understand what they’re sharing.</p>
<p>This is particularly a problem with directory requests, where all files
inside of a directory are shared. For people who primarily grew up with
mobile operating systems, the concept of directory trees might even be
entirely foreign, further making it hard for them to make any reasonable
risk assessment.</p>
<p>For web Kate we rely on the browser’s mitigations. For native Kate we
mitigate with a separate confirmation step in the directory access case.</p>
</dd>
<dt><strong>Tree privilege escalation:</strong></dt><dd><p>Because the API provides access to directories, symbolic links within
it could be used to escalate access to a directory outside of the
subtree that the user granted access to.</p>
<p>We rely on the browser’s mitigation for symbolic links and do not include
grants to links in native Kate.</p>
</dd>
<dt><strong>Access to hidden files:</strong></dt><dd><p>Because OS file pickers may not show hidden files by default, it’s possible
that a user grants access to a directory that contains files they never
meant to grant access to.</p>
<p>We rely on the same mitigation as that for sensitive data to cover hidden
files.</p>
</dd>
<dt><strong>Direct access to devices:</strong></dt><dd><p>Because some OSs (e.g.: Linux) expose devices as files, it’s possible that
a user grants access to a file or directory that is backed by a device,
and hence grant the cartridge direct read access to that device’s data.</p>
<p>We mitigate this by only allowing users to select user-data files and
directories. Browsers have a similar mitigation for device files.</p>
</dd>
</dl>
</section>
<section id="additional-references">
<h2>Additional references<a class="headerlink" href="#additional-references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://wicg.github.io/file-system-access/">File System Access API (WICG draft spec)</a></p></li>
<li><p><a class="reference external" href="https://w3c.github.io/FileAPI/">File API (WICG spec)</a></p></li>
<li><p><a class="reference external" href="https://developer.chrome.com/articles/file-system-access/">Chrome’s File System API blogpost</a></p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../etc/releases/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Release notes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="01XX-external-url.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">#01XX — External URL navigation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Q.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">#01XX — Device file access</a><ul>
<li><a class="reference internal" href="#timeline">Timeline</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#technical-implementation">Technical implementation</a></li>
<li><a class="reference internal" href="#formal-semantics">Formal semantics</a><ul>
<li><a class="reference internal" href="#requesting-capabilities">Requesting capabilities</a><ul>
<li><a class="reference internal" href="#fs-request-file-filter"><code class="docutils literal notranslate"><span class="pre">fs.request-file(filter)</span></code></a></li>
<li><a class="reference internal" href="#fs-request-directory"><code class="docutils literal notranslate"><span class="pre">fs.request-directory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#file-metadata">File metadata</a><ul>
<li><a class="reference internal" href="#f-relative-path"><code class="docutils literal notranslate"><span class="pre">f.relative-path()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#file-operations">File operations</a><ul>
<li><a class="reference internal" href="#f-read"><code class="docutils literal notranslate"><span class="pre">f.read()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-is-this-feature-dangerous">How is this feature dangerous?</a></li>
<li><a class="reference internal" href="#additional-references">Additional references</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>