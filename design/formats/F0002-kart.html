<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="#K0001 — Capabilities" href="../kernel/K0001-capabilities.html" /><link rel="prev" title="#F0001 — The LJT language" href="F0001-ljt.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>#F0002 — KART cartridges - Kate 0.23.10 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=82a976d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=d1035e3f" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     Both Kate and this documentation are a work in progress and may change at any time. 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Kate 0.23.10 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Kate 0.23.10 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">End-user books</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user/manual/index.html">The Kate User Manual</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of The Kate User Manual</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../user/manual/intro/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Getting started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/intro/hardware.html">Tech specs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/intro/emulator.html">Emulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/intro/install.html">Installing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../user/manual/gaming/index.html">Playing games</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Playing games</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/gaming/cartridges.html">ROM Cartridges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/gaming/captures.html">Screen recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/gaming/save-data.html">Save data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/gaming/play-habits.html">Play habits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/gaming/storage.html">Stored data</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../user/manual/security/index.html">Security and privacy</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Security and privacy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/security/philosophy.html">Safety philosophy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/security/sandboxing.html">Sandboxing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/security/privacy.html">Privacy policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/security/trust.html">Trust and consent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user/manual/security/audit.html">Audit logs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user/importer/index.html">The Kate Importer Manual</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of The Kate Importer Manual</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user/importer/renpy.html">Ren’Py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user/importer/bitsy.html">Bitsy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user/diy/index.html">Build Your Own Console!</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Build Your Own Console!</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user/diy/overview/index.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user/diy/hardware/index.html">The hardware</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Game developer books</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dev/manual/index.html">Making games for Kate!</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Making games for Kate!</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dev/manual/intro/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Getting started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/intro/why.html">Why make games for Kate?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/intro/setup.html">What will you need?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/intro/hello-world.html">Hello, World</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dev/manual/model/index.html">Programming model</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Programming model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/model/overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/model/cartridges.html">Cartridges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/model/sandboxing.html">Sandboxing and APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/model/capabilities.html">Capabilities</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dev/manual/api/index.html">Kate API</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Kate API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/api/events.html"><code class="docutils literal notranslate"><span class="pre">events</span></code> — Event handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/api/cart-fs.html"><code class="docutils literal notranslate"><span class="pre">cart_fs</span></code> — Reading files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/api/input.html"><code class="docutils literal notranslate"><span class="pre">*_input</span></code> — Reacting to player input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/api/timer.html"><code class="docutils literal notranslate"><span class="pre">timer</span></code> — Scheduling updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/api/capture.html"><code class="docutils literal notranslate"><span class="pre">capture</span></code> — Screenshots and video recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/api/store.html"><code class="docutils literal notranslate"><span class="pre">store</span></code> — Saving state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/api/browser.html"><code class="docutils literal notranslate"><span class="pre">browser</span></code> — Navigating to URLs</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dev/manual/web/index.html">Web game support</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Web game support</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/web/basics.html">Basics of porting</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../dev/manual/web/bridges/index.html">Bridges</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Bridges</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/network-proxy.html">Network proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/input-proxy.html">Button input proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/pointer-input-proxy.html">Pointer input proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/local-storage-proxy.html">Local storage proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/indexeddb-proxy.html">IndexedDB proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/external-url-handler.html">External URL handler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/preserve-webgl-render.html">Preserve WebGL Render</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/capture-canvas.html">Capture canvas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dev/manual/web/bridges/renpy-tweaks.html">Ren’Py tweaks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dev/manual/kart/index.html">Kart — Packing cartridges</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Kart — Packing cartridges</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/kart/getting-started.html">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dev/manual/kart/configuration.html">Configuration files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dev/port/index.html">Kate Porting Recipes</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Kate Porting Recipes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dev/port/bitsy.html">Bitsy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev/port/renpy.html">Ren’Py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev/port/godot.html">Godot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev/port/rpg-maker.html">RPG Maker MV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev/port/gamemaker.html">GameMaker</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design and implementation</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Kate’s Design Documents</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Kate’s Design Documents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="F0001-ljt.html">#F0001 — The LJT language</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">#F0002 — KART cartridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/K0001-capabilities.html">#K0001 — Capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/K0002-live-audit.html">#K0002 — Live auditing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/K0003-resource-band.html">#K0003 — Resource band</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/K0004-processes.html">#K0004 — Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/K0005-partitioned-file-storage.html">#K0005 — Partitioned File Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/K0006-cartridge-signatures.html">#K0006 — Cartridge signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/K0007-key-store.html">#K0006 — Cartridge signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/A0001-object-storage.html">#A0001 — Object Store API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/A0002-external-url.html">#A0002 — External URL navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/A0003-device-file-access.html">#A0003 — Device file access</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changes, Terms, and Credits</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../etc/releases/index.html">Release notes</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Release notes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../etc/releases/0.23.10.html">Kate v0.23.10  (October 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../etc/releases/0.23.8.html">Kate v0.23.8  (August 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../etc/releases/0.23.6.html">Kate v0.23.6  (June 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../etc/releases/0.23.5.html">Kate v0.23.5  (May 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../etc/releases/0.23.4.html">Kate v0.23.4  (April 2023)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../etc/licence.html">Terms of use</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../py-modindex.html">Module Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/qteatime/kate/edit/main/docs/source/design/formats/F0002-kart.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="f0002-kart-cartridges">
<h1>#F0002 — KART cartridges<a class="headerlink" href="#f0002-kart-cartridges" title="Link to this heading">#</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Niini</p>
</dd>
<dt class="field-even">Started<span class="colon">:</span></dt>
<dd class="field-even"><p>2023-12-30</p>
</dd>
<dt class="field-odd">Last updated<span class="colon">:</span></dt>
<dd class="field-odd"><p>2023-12-30</p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>Design in progress</p>
</dd>
</dl>
<section id="timeline">
<h2>Timeline<a class="headerlink" href="#timeline" title="Link to this heading">#</a></h2>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>First draft</p></th>
<th class="head"><p>Proof of Concept</p></th>
<th class="head"><p>Stable implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2023-12-30</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>Applications in Kate are distributed as a single binary blob containing all of
the data that is needed to execute the application. There are a few properties
we are interested in for such format:</p>
<ul class="simple">
<li><p><strong>Direct execution</strong>: It should be possible (but not mandatory!) to execute
the application directly from the binary blob without loading all of it in
memory at once. Blobs for games can easily be several gigabytes in size.</p></li>
<li><p><strong>Bounded memory codecs</strong>: Related to the requirement above, it should be
possible to decode and encode cartridge blobs while using bounded memory,
but not necessarily <em>constant</em> memory.</p></li>
<li><p><strong>Rich metadata</strong>: It should be possible to encode rich metadata about the
application, as Kate uses this to enable displaying and searching for
cartridges in the console and the store.</p></li>
<li><p><strong>Multiparty whole-cartridge signatures</strong>: It should be possible to sign
the whole cartridge by multiple signees. We expect authors to sign their
own cartridges to ensure provision, but we may also require a
“trusted signee” to allow access to more powerful features like network
access — this would allow veto signatures from trusted independent auditors.</p></li>
<li><p><strong>Block integrity checking</strong>: It should be possible to check that the
contents of the cartridge have not been corrupted <em>even when no signature
is present</em>.</p></li>
<li><p><strong>Backwards compatibility</strong>: It should be possible to amend the schema for the
cartridge without invalidating previous cartridges. A cartridge released for
Kate <strong>must</strong> be decodable by all future versions of the console, otherwise
we would fail the goal of being a platform for video-game preservation.</p></li>
<li><p><strong>Forward evolution</strong>: It should be possible to <em>distribute</em> cartridges made
with a version X of the schema, and get a clear error indicating that the
user needs to upgrade their console to version Y in order to decode the
cartridge.</p></li>
</ul>
<p>Towards that end, Kate cartridges (<code class="docutils literal notranslate"><span class="pre">.KART</span></code> files) are an uncompressed archive
format that ending with a metadata blob and content location tables.</p>
</section>
<section id="technical-summary">
<h2>Technical summary<a class="headerlink" href="#technical-summary" title="Link to this heading">#</a></h2>
<p>Kate cartridges are a binary archive format comprised of four sections:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-- The schema signature magic bytes + version
0x0000    K A R T
0x0004    version: uint32                   -- the LJT schema version used

-- The binary file contents
0x0000    count: uint32                     -- the number of files
0x0004    size: uint32                    \
0x0008    file contents (up to `size`)    | -- repeated for each file
...

-- The metadata blob
0x0000    LJT encoding of `Metadata` record (magic-less)

-- The header blob
0x0000    LJT encoding of `Header` record (magic-less)
</pre></div>
</div>
<p>For the LJT specification, see <a class="reference internal" href="F0001-ljt.html"><span class="doc">#F0001 — The LJT language</span></a>. All numbers in the cartridge
are encoded using little-endian encoding, and all of them have a fixed size.</p>
<p>The current LJT schema used is version 6. You can find all LJT schemas in
the <a class="reference external" href="https://github.com/qteatime/kate/tree/main/packages/schema/schemas">‘schema’ package</a>
in Kate’s repository.</p>
<p>The most relevant portions of this schema, for decoding, are the Header type
and the file and signature tables in the Metadata type. They have approximately
the following shape:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span><span class="w"> </span><span class="nx">Header</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">minimum</span><span class="o">-</span><span class="nx">kate</span><span class="o">-</span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">major</span><span class="o">:</span><span class="w"> </span><span class="kt">uint32</span>
<span class="w">    </span><span class="nx">minor</span><span class="o">:</span><span class="w"> </span><span class="kt">uint32</span>
<span class="w">    </span><span class="nx">patch</span><span class="o">:</span><span class="w"> </span><span class="kt">uint32</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">metadata</span><span class="o">-</span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">offset</span><span class="o">:</span><span class="w"> </span><span class="kt">uint64</span>
<span class="w">    </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="kt">uint64</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">content</span><span class="o">-</span><span class="nx">location</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">offset</span><span class="o">:</span><span class="w"> </span><span class="kt">uint64</span>
<span class="w">    </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="kt">uint64</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">Metadata</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ...(other fields omitted)</span>
<span class="w">  </span><span class="nx">files</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span>
<span class="w">    </span><span class="nx">path</span><span class="o">:</span><span class="w"> </span><span class="kt">text</span>
<span class="w">    </span><span class="nx">mime</span><span class="o">:</span><span class="w"> </span><span class="kt">text</span>
<span class="w">    </span><span class="nx">integrity</span><span class="o">:</span><span class="w"> </span><span class="kt">raw</span><span class="o">-</span><span class="nx">bytes</span>
<span class="w">    </span><span class="nx">hash</span><span class="o">-</span><span class="nx">algorithm</span><span class="o">:</span><span class="w"> </span><span class="kt">Sha</span><span class="o">-</span><span class="mf">512</span><span class="w"> </span><span class="p">(</span><span class="kr">as</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">LJT</span><span class="w"> </span><span class="nx">record</span><span class="p">)</span>
<span class="w">    </span><span class="nx">offset</span><span class="o">:</span><span class="w"> </span><span class="kt">uint64</span>
<span class="w">    </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="kt">uint32</span><span class="w">    </span><span class="p">(</span><span class="nx">individual</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">always</span><span class="w"> </span><span class="nx">limited</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="mf">4</span><span class="nx">GB</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">  </span><span class="nx">signature</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span>
<span class="w">    </span><span class="nx">signed</span><span class="o">-</span><span class="nx">by</span><span class="o">:</span><span class="w"> </span><span class="kt">text</span>
<span class="w">    </span><span class="nx">key</span><span class="o">-</span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">text</span><span class="p">;</span>
<span class="w">    </span><span class="nx">signature</span><span class="o">:</span><span class="w"> </span><span class="kt">raw</span><span class="o">-</span><span class="nx">bytes</span>
<span class="w">  </span><span class="p">}</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The process of encoding a Kate cartridge starts by first writing all of the
files to the archive (and keeping track of their metadata), then writing the
cartridge metadata which includes a location table to each file giving their
offset in the archive and an integrity hash. Lastly, the Header section is
written which gives information on where the metadata and file blobs are.</p>
<p>The process of decoding a Kate cartridge will generally start by looking at
the Header at the end of the file, then decoding the Metadata section, then
using the file location table in the metadata to decode individual files at
their specified offsets. While a Kate cartridge can also be decoded in a
stream fashion, from beginning to end, it would not be possible to do
integrity checks in this manner as that data is only present in the metadata
blob.</p>
<p>Note that the signature is only present in the metadata blob, and it <em>only</em>
signs the metadata blob (with an empty signature list). That means files are
not signed directly, but their integrity hash in the content location table
is.</p>
<section id="reference-codecs">
<h3>Reference codecs<a class="headerlink" href="#reference-codecs" title="Link to this heading">#</a></h3>
<p>The codec modules in <a class="reference external" href="https://github.com/qteatime/kate/blob/main/packages/schema/source/">the ‘schema’ package</a>
act as a reference implementation for the blob decoding.
The <a class="reference external" href="https://github.com/qteatime/kate/tree/main/packages/ljt-vm">LJT VM</a> is
the reference implementation for encoding and decoding the LJT sections of the
file.</p>
</section>
<section id="direct-execution">
<h3>Direct execution<a class="headerlink" href="#direct-execution" title="Link to this heading">#</a></h3>
<p>Kate cartridges can be executed directly from the binary blob, as long as
the IO device supports random-access to parts of the blob. For IO devices
that <em>only</em> support streaming, the blob must be decoded into individual
components and stored somewhere that allows access to the individual
components prior to executing it — streaming execution is not possible
and not a goal.</p>
<p>Here we start by decoding the Header section of the cartridge, then we
find and decode the Metadata section which contains information about which
runtime to use to execute the cartridge and a file location table for all
the (read-only) contents of the cartridge.</p>
<p>By loading the runtime and feeding it the file location table, the runtime
can then pick the files it needs from the given offsets in the cartridge
blob without needing a separate pass where those files are written to
another storage location.</p>
</section>
<section id="bounded-memory-codecs">
<h3>Bounded memory codecs<a class="headerlink" href="#bounded-memory-codecs" title="Link to this heading">#</a></h3>
<p>Kate cartridge blobs require at most <code class="docutils literal notranslate"><span class="pre">max(block-size...)</span></code> bytes of memory to
decode, but there’s no constant number that can be used to pre-allocate a single
decoding buffer. Each block has different sizes, either indicated at the start
of the block, as it’s the case with files, or in the Header location table,
as it’s the case with the Metadata block. The Header location table itself is
fixed-size, but that size might change between schema versions.</p>
</section>
<section id="rich-metadata">
<h3>Rich metadata<a class="headerlink" href="#rich-metadata" title="Link to this heading">#</a></h3>
<p>The Metadata section includes information on how to uniquely identify the
cartridge, as well as how to present it, how to classify it, its legally
binding documents, accessibility provisions, security requirements, and
how to execute the cartridge application (allowing for different runtimes
to use the same archive format).</p>
<p>Because these only have their semantic defined by the interpreter of the
cartridge, we don’t discuss them in this document. How Kate interprets
these fields is described in <a class="reference internal" href="../../dev/manual/model/cartridges.html"><span class="doc">Cartridges</span></a> and
<a class="reference internal" href="../../dev/manual/kart/configuration.html"><span class="doc">Configuration files</span></a>.</p>
</section>
<section id="multi-party-whole-cartridge-signatures">
<h3>Multi-party, whole cartridge signatures<a class="headerlink" href="#multi-party-whole-cartridge-signatures" title="Link to this heading">#</a></h3>
<p>The primary purpose of Kate cartridge signatures is to ensure that the
cartridge was made by whoever is distributing it, and that entity has
ownership over the domain they specified in the cartridge identification.
Because Kate cartridges <em>are not required to be distributed in a central place</em>,
a malicious attacker could publish a cartridge named <code class="docutils literal notranslate"><span class="pre">qteati.me/cute-game</span></code>
with outrageous capability requests and trick people into thinking that
comes from the maintainers of Kate. Signatures are primarily a means to
avoid this situation, by tying the signature key to the domain.</p>
<p>The secondary goal of signatures is to allow independent “vouching” for a
cartridge, particularly ones that require powerful capabilities. For example,
you might not immediately trust a cartridge asking for network access if it
comes from a developer you never consumed things from before. But if a person
you trust vouched for them, you would be more likely to trust it.</p>
<p>The signature block in the cartridge metadata supports both of these goals.
Each signature includes the signee and the signature. The signee is a domain
name which is then used to find which public keys are associated with it. The
signature succeeds in being verified if the specified public keys for that signee
can verify it.</p>
<p>Note that we <strong>only</strong> sign and verify the metadata binary (with an empty
signature list). This is enough to indicate a high degree of trust that the
cartridge does belong to the sources it specifies, and has been vouched for
by the people listed in the signatures. Signature verification however does
not prevent a cartridge from being executed — that would be problematic
for the goal of video game preservation, particularly given how Kate ties it
to ephemeral domain names. It’s only another indication for players to take
into account when choosing whether to grant capabilities or not, but
capabilities remain the only <em>damage-mitigation security feature</em> that Kate
provides.</p>
<p>Verifying signatures by signee allows us to partially verify a cartridge and
show that to players as well, when aiding them in assessing the risk of
granting capabilities.</p>
</section>
<section id="block-integrity-checking">
<h3>Block integrity checking<a class="headerlink" href="#block-integrity-checking" title="Link to this heading">#</a></h3>
<p>The metadata section in the cartridge includes integrity hashes for all of
the files in the cartridge. By decoding the meta-data first a program is
able to verify the files as they decode them. By decoding the meta-data last,
a program is able to verify the files after-the-fact, as long as the program
writes them to some temporary storage.</p>
<p>In both cases the cartridge files can be checked for corruption. The metadata
and header blocks do not have an integrity hash, and so cannot be checked for
corruption in the same manner. Signature verification in the metadata blob
is a stronger indication of integrity, but requires the public key to be
available for testing.</p>
<p>Kate cartridge blobs have no self-correcting error mechanism. We expect the
underlying file storage to provide that. And in the case of network transfers
of cartridge blobs, we expect the protocol to ensure integrity, or that this
is verified with an out-of-band integrity hash of the whole cartridge binary.</p>
</section>
<section id="backwards-compatibility-and-forwards-evolution">
<h3>Backwards compatibility and forwards evolution<a class="headerlink" href="#backwards-compatibility-and-forwards-evolution" title="Link to this heading">#</a></h3>
<p>Kate cartridges use a versioned LJT schema for most parts. LJT itself specifies
backwards compatibility through versioning and patching semantics, so you need
to read the LJT specification (<a class="reference internal" href="F0001-ljt.html"><span class="doc">#F0001 — The LJT language</span></a>) to understand that in more
details.</p>
<p>Forwards evolution is a bit trickier. The schema version <em>does</em> tell the
program that the cartridge cannot be decoded, but it does not really tell
the user what they have to do to fix that. To address this the header is
stable across versions and contains the minimum Kate version needed to
decode the cartridge. This addresses the issue from the users’ perspective,
but only for Kate itself.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../kernel/K0001-capabilities.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">#K0001 — Capabilities</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="F0001-ljt.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">#F0001 — The LJT language</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Niini
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">#F0002 — KART cartridges</a><ul>
<li><a class="reference internal" href="#timeline">Timeline</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#technical-summary">Technical summary</a><ul>
<li><a class="reference internal" href="#reference-codecs">Reference codecs</a></li>
<li><a class="reference internal" href="#direct-execution">Direct execution</a></li>
<li><a class="reference internal" href="#bounded-memory-codecs">Bounded memory codecs</a></li>
<li><a class="reference internal" href="#rich-metadata">Rich metadata</a></li>
<li><a class="reference internal" href="#multi-party-whole-cartridge-signatures">Multi-party, whole cartridge signatures</a></li>
<li><a class="reference internal" href="#block-integrity-checking">Block integrity checking</a></li>
<li><a class="reference internal" href="#backwards-compatibility-and-forwards-evolution">Backwards compatibility and forwards evolution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=1b0dedb3"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>